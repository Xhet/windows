# -*- coding: utf-8 -*-

# try:
#     page.wait.until(EC.presence_of_element_located((By.ID, "jqxWidgetcf26695c").send_keys("proj01")
#     page.wait.until(EC.presence_of_element_located((By.ID, "jqxWidget2e1c4f6b").send_keys("wireline")

###########  page.find_element_by_xpath("(//div[@class='sodLabel fl'])[0]").text.re.findall(r"[\w']+",data)[2]
# finally:
#     page.find_element_by_id("jqxWidgetcf26695c").send_keys(Keys.RETURN)
#     page.find_element_by_id("jqxWidget2e1c4f6b").send_keys(Keys.RETURN)

# try :
#     page.find_element_by_name("task_by_worker_cost_center_taskCode_sch").send_keys("proj01")
#     page.find_element_by_name("task_by_worker_cost_center_taskName_sch").send_keys("wireline")

# finally:
#     page.find_element_by_name("task_by_worker_cost_center_search").send_keys(Keys.RETURN)
# page.find_element_by_xpath("//a[@id='edit_segmented_cf_VZGTWK00009469_z1611181808392235474182b_z1611151626282762828590b_z18031120572845935344906_1z1611111809130665190690fz1611111817013817038990f']/span").click()

# for code, id_code, edit_code in variables.task_code:
#     page.find_element_by_xpath("//a[@id='{}{}']/span".format(variables.edit, edit_code)).click()
#     page.find_element_by_id(variables.task_id + "1" +"__segment1").send_keys(code)
#     time.sleep(4)
#     page.find_element_by_id(variables.task_id + "1" +"__segment1").send_keys(Keys.ARROW_DOWN)
#     page.find_element_by_id(variables.task_id + "1" +"__segment1").send_keys(Keys.RETURN)

# ##############################################
#     time.sleep(6)
#     page.find_element_by_id(variables.task_id + "1" +"__segment2").send_keys(id_code)
#     time.sleep(4)
#     page.find_element_by_id(variables.task_id + "1" +"__segment2").send_keys(Keys.ARROW_DOWN)
#     page.find_element_by_id(variables.task_id + "1" +"__segment2").send_keys(Keys.RETURN)

# ##########################################################
#     time.sleep(6)
#     page.find_element_by_id(variables.task_id + "1" +"__segment3").send_keys("06a")
#     time.sleep(4)
#     page.find_element_by_id(variables.task_id + "1" +"__segment3").send_keys(Keys.ARROW_DOWN)
#     page.find_element_by_id(variables.task_id + "1" +"__segment3").send_keys(Keys.RETURN)
#     page.find_element_by_link_text("Cancel").click()

# try:
#   glob = wait.until(EC.presence_of_element_located((By.XPATH, "//input[@name='cSelCheckBox' and @value='{}']".format(variables.codes[0]))))
#   ebonding = wait.until(EC.presence_of_element_located((By.XPATH, "//input[@name='cSelCheckBox' and @value='{}']".format(variables.codes[1]))))
#   aws = wait.until(EC.presence_of_element_located((By.XPATH, "//input[@name='cSelCheckBox' and @value='{}']".format(variables.codes[2]))))
# finally:
#     ebonding.click()
#     aws.click()
#     glob.click()

#==============EDIT BUTTONS===============
# edit_segmented_cf_VZGTWK00009469_z1611181808392235474182b_z1611151626282762828590b_z18031120572845935344906_2z1611111809130665190690fz1611111817013817038990f
# edit_segmented_cf_VZGTWK00009469_z1611181808392235474182b_z1611151626282762828590b_z18031120572845935344906_1z1611111809130665190690fz1611111817013817038990f
# ebonding.click()
# aws.click()
# glob.click()


# conti = page.find_element_by_xpath("//input[@class='primaryButton' and @value='Continue']")
# # glob = page.find_element_by_xpath("//input[@name='cSelCheckBox' and @value='z1611151626282762828590b&z1611181808392235474182b&z1803072201115031420892e&z16123115494271934691922&z17120617390860963784919&Wireline IT|00VZ007747~Virtual Services~PCCIO~C|23720~Global Change Management|FUNCTIONALITY TESTING & INSTALL - EXCLUDES UAT~06A~SOW_SOP~193132~5320']")
# # ebonding = page.find_element_by_xpath("//input[@name='cSelCheckBox' and @value='z1611151626282762828590b&z1611181808392235474182b&z1803072201115031420892e&z16123115494271934691922&z17120617390860963784919&Wireline IT|00VZ007898~Global eBonding Deals~PCCIO~C|14815~Verizon Business Ebonding Solu|FUNCTIONALITY TESTING & INSTALL - EXCLUDES UAT~06A~SOW_SOP~193132~5320']")
# # aws = page.find_element_by_xpath("//input[@name='cSelCheckBox' and @value='z1611151626282762828590b&z1611181808392235474182b&z1803072201115031420892e&z16123115494271934691922&z17120617390860963784919&Wireline IT|00VZ007942~AWS Migration (Expense)~PCCIO~E|19443~Verizon Enterprise Center|FUNCTIONALITY TESTING & INSTALL - EXCLUDES UAT~06A~SOW_EXPENSE~780025~']")
# https://www.dsogaming.com/articles/report-the-pirated-version-of-final-fantasy-xv-runs-faster-better-than-the-steam-version/
# # -*- coding: utf-8 -*-
# # f

# monday = t_z17102516194911574423935_b_2_r1
# monday2 = t_z17102516194911574423935_b_2_r2


# task=page.find_element_by_id("jqxWidgetcf26695c")
# task.send_keys("proj01")
# task.send_keys(Keys.RETURN)
# task_name=page.find_element_by_id("jqxWidget2e1c4f6b")
# task_name.send_keys("wireline")
# task_name.send_keys(Keys.RETURN)
# 

# codes = ["z1611151626282762828590b&z1611181808392235474182b&z1803072201115031420892e&z16123115494271934691922&z17120617390860963784919&Wireline IT|00VZ007747~Virtual Services~PCCIO~C|23720~Global Change Management|FUNCTIONALITY TESTING & INSTALL - EXCLUDES UAT~06A~SOW_SOP~193132~5320", "z1611151626282762828590b&z1611181808392235474182b&z1803072201115031420892e&z16123115494271934691922&z17120617390860963784919&Wireline IT|00VZ007898~Global eBonding Deals~PCCIO~C|14815~Verizon Business Ebonding Solu|FUNCTIONALITY TESTING & INSTALL - EXCLUDES UAT~06A~SOW_SOP~193132~5320", "z1611151626282762828590b&z1611181808392235474182b&z1803072201115031420892e&z16123115494271934691922&z17120617390860963784919&Wireline IT|00VZ007942~AWS Migration (Expense)~PCCIO~E|19443~Verizon Enterprise Center|FUNCTIONALITY TESTING & INSTALL - EXCLUDES UAT~06A~SOW_EXPENSE~780025~"]
# sele.send_keys("00VZ007747")
# sele.send_keys(Keys.ARROW_DOWN)
# sele.send_keys(Keys.RETURN)

from selenium import webdriver
from selenium.webdriver.common.by import By
from selenium.webdriver.common.keys import Keys
from selenium.webdriver.support.ui import Select
from selenium.common.exceptions import NoSuchElementException
from selenium.common.exceptions import NoAlertPresentException
import unittest, time, re

class Fieldglass(unittest.TestCase):
    def setUp(self):
        self.driver = webdriver.Firefox()
        self.driver.implicitly_wait(30)
        self.base_url = "https://www.katalon.com/"
        self.verificationErrors = []
        self.accept_next_alert = True
    
    def test_fieldglass(self):
        driver = self.driver
        driver.get("https://www.fieldglass.net/")
        driver.find_element_by_id("usernameId_new").click()
        driver.find_element_by_id("usernameId_new").clear()
        driver.find_element_by_id("usernameId_new").send_keys("casader")
        driver.find_element_by_id("passwordId_new").clear()
        driver.find_element_by_id("passwordId_new").send_keys("Eri809@03")
        driver.find_element_by_id("passwordId_new").send_keys(Keys.ENTER)
        driver.find_element_by_id("ts_1").click()
        # driver.find_element_by_id("jqxWidgetb6e2710c").click()
        # driver.find_element_by_id("jqxWidgetb6e2710c").clear()
        # driver.find_element_by_id("jqxWidgetb6e2710c").send_keys("proj01")
        # driver.find_element_by_name("timeSheetForm").submit()
        # driver.find_element_by_id("jqxWidgetbb9f9498").click()
        # driver.find_element_by_id("jqxWidgetbb9f9498").clear()
        # driver.find_element_by_id("jqxWidgetbb9f9498").send_keys("wireline")
        # driver.find_element_by_name("timeSheetForm").submit()
        driver.find_element_by_xpath("(//input[@name='cSelCheckBox'])[4]").click()
        driver.find_element_by_xpath("(//input[@name='cSelCheckBox'])[5]").click()
        driver.find_element_by_xpath("(//input[@name='cSelCheckBox'])[6]").click()
        driver.find_element_by_xpath("//input[@value='Continue']").click()
        driver.find_element_by_xpath("//a[@id='edit_segmented_cf_VZGTWK00009469_z1611181808392235474182b_z1611151626282762828590b_z18031120572845935344906_1z1611111809130665190690fz1611111817013817038990f']/span").click()
        page.find_element_by_id("select_label_z1611111809130665190690fz1611111817013817038990f_VZGTWK00009469_z1611181808392235474182b_z1611151626282762828590b_z18031120572845935344906_1__segment1").click()
        page.find_element_by_id("select_label_z1611111809130665190690fz1611111817013817038990f_VZGTWK00009469_z1611181808392235474182b_z1611151626282762828590b_z18031120572845935344906_1__segment1").send_keys(Keys.DOWN)
        page.find_element_by_id("select_label_z1611111809130665190690fz1611111817013817038990f_VZGTWK00009469_z1611181808392235474182b_z1611151626282762828590b_z18031120572845935344906_1__segment1").clear()
        page.find_element_by_id("select_label_z1611111809130665190690fz1611111817013817038990f_VZGTWK00009469_z1611181808392235474182b_z1611151626282762828590b_z18031120572845935344906_1__segment1").send_keys("00VZ007898~Global eBonding Deals~PCCIO~C")
        page.find_element_by_name("timeSheetForm").submit()
        driver.find_element_by_id("select_label_z1611111809130665190690fz1611111817013817038990f_VZGTWK00009469_z1611181808392235474182b_z1611151626282762828590b_z18031120572845935344906_1__segment2").click()
        driver.find_element_by_id("select_label_z1611111809130665190690fz1611111817013817038990f_VZGTWK00009469_z1611181808392235474182b_z1611151626282762828590b_z18031120572845935344906_1__segment2").send_keys(Keys.DOWN)
        driver.find_element_by_id("select_label_z1611111809130665190690fz1611111817013817038990f_VZGTWK00009469_z1611181808392235474182b_z1611151626282762828590b_z18031120572845935344906_1__segment2").clear()
        driver.find_element_by_id("select_label_z1611111809130665190690fz1611111817013817038990f_VZGTWK00009469_z1611181808392235474182b_z1611151626282762828590b_z18031120572845935344906_1__segment2").send_keys("14815~Verizon Business Ebonding Solu")
        driver.find_element_by_name("timeSheetForm").submit()
        driver.find_element_by_id("select_label_z1611111809130665190690fz1611111817013817038990f_VZGTWK00009469_z1611181808392235474182b_z1611151626282762828590b_z18031120572845935344906_1__segment3").click()
        driver.find_element_by_id("select_label_z1611111809130665190690fz1611111817013817038990f_VZGTWK00009469_z1611181808392235474182b_z1611151626282762828590b_z18031120572845935344906_1__segment3").send_keys(Keys.DOWN)
        driver.find_element_by_id("select_label_z1611111809130665190690fz1611111817013817038990f_VZGTWK00009469_z1611181808392235474182b_z1611151626282762828590b_z18031120572845935344906_1__segment3").clear()
        driver.find_element_by_id("select_label_z1611111809130665190690fz1611111817013817038990f_VZGTWK00009469_z1611181808392235474182b_z1611151626282762828590b_z18031120572845935344906_1__segment3").send_keys("FUNCTIONALITY TESTING & INSTALL - EXCLUDES UAT~06A~LABOR_SOP~193132~5320")
        driver.find_element_by_name("timeSheetForm").submit()
        driver.find_element_by_link_text("Update").click()
        driver.find_element_by_xpath("//a[@id='edit_segmented_cf_VZGTWK00009469_z1611181808392235474182b_z1611151626282762828590b_z18031120572845935344906_2z1611111809130665190690fz1611111817013817038990f']/span").click()
        driver.find_element_by_id("select_label_z1611111809130665190690fz1611111817013817038990f_VZGTWK00009469_z1611181808392235474182b_z1611151626282762828590b_z18031120572845935344906_2__segment1").click()
        driver.find_element_by_id("select_label_z1611111809130665190690fz1611111817013817038990f_VZGTWK00009469_z1611181808392235474182b_z1611151626282762828590b_z18031120572845935344906_2__segment1").send_keys(Keys.DOWN)
        driver.find_element_by_id("select_label_z1611111809130665190690fz1611111817013817038990f_VZGTWK00009469_z1611181808392235474182b_z1611151626282762828590b_z18031120572845935344906_2__segment1").clear()
        driver.find_element_by_id("select_label_z1611111809130665190690fz1611111817013817038990f_VZGTWK00009469_z1611181808392235474182b_z1611151626282762828590b_z18031120572845935344906_2__segment1").send_keys("00VZ007747~Virtual Services~PCCIO~C")
        driver.find_element_by_name("timeSheetForm").submit()
        driver.find_element_by_id("select_label_z1611111809130665190690fz1611111817013817038990f_VZGTWK00009469_z1611181808392235474182b_z1611151626282762828590b_z18031120572845935344906_2__segment2").click()
        driver.find_element_by_id("ui-id-657").click()
        driver.find_element_by_id("select_label_z1611111809130665190690fz1611111817013817038990f_VZGTWK00009469_z1611181808392235474182b_z1611151626282762828590b_z18031120572845935344906_2__segment2").clear()
        driver.find_element_by_id("select_label_z1611111809130665190690fz1611111817013817038990f_VZGTWK00009469_z1611181808392235474182b_z1611151626282762828590b_z18031120572845935344906_2__segment2").send_keys("23720~Global Change Management")
        driver.find_element_by_id("select_label_z1611111809130665190690fz1611111817013817038990f_VZGTWK00009469_z1611181808392235474182b_z1611151626282762828590b_z18031120572845935344906_2__segment3").click()
        driver.find_element_by_xpath("(//a[contains(text(),'FUNCTIONALITY TESTING & INSTALL - EXCLUDES UAT~06A~LABOR_SOP~193132~5320')])[2]").click()
        driver.find_element_by_id("select_label_z1611111809130665190690fz1611111817013817038990f_VZGTWK00009469_z1611181808392235474182b_z1611151626282762828590b_z18031120572845935344906_2__segment3").clear()
        driver.find_element_by_id("select_label_z1611111809130665190690fz1611111817013817038990f_VZGTWK00009469_z1611181808392235474182b_z1611151626282762828590b_z18031120572845935344906_2__segment3").send_keys("FUNCTIONALITY TESTING & INSTALL - EXCLUDES UAT~06A~LABOR_SOP~193132~5320")
        driver.find_element_by_xpath("(//a[contains(text(),'Update')])[2]").click()
        driver.find_element_by_xpath("//a[@id='edit_segmented_cf_VZGTWK00009469_z1611181808392235474182b_z1611151626282762828590b_z18031120572845935344906_3z1611111809130665190690fz1611111817013817038990f']/span").click()
        driver.find_element_by_id("select_label_z1611111809130665190690fz1611111817013817038990f_VZGTWK00009469_z1611181808392235474182b_z1611151626282762828590b_z18031120572845935344906_3__segment1").click()
        driver.find_element_by_id("ui-id-879").click()
        driver.find_element_by_id("select_label_z1611111809130665190690fz1611111817013817038990f_VZGTWK00009469_z1611181808392235474182b_z1611151626282762828590b_z18031120572845935344906_3__segment1").clear()
        driver.find_element_by_id("select_label_z1611111809130665190690fz1611111817013817038990f_VZGTWK00009469_z1611181808392235474182b_z1611151626282762828590b_z18031120572845935344906_3__segment1").send_keys("00VZ007942~AWS Migration (Expense)~PCCIO~E")
        driver.find_element_by_id("select_label_z1611111809130665190690fz1611111817013817038990f_VZGTWK00009469_z1611181808392235474182b_z1611151626282762828590b_z18031120572845935344906_3__segment2").click()
        driver.find_element_by_id("select_label_z1611111809130665190690fz1611111817013817038990f_VZGTWK00009469_z1611181808392235474182b_z1611151626282762828590b_z18031120572845935344906_3__segment2").send_keys(Keys.DOWN)
        driver.find_element_by_id("select_label_z1611111809130665190690fz1611111817013817038990f_VZGTWK00009469_z1611181808392235474182b_z1611151626282762828590b_z18031120572845935344906_3__segment2").clear()
        driver.find_element_by_id("select_label_z1611111809130665190690fz1611111817013817038990f_VZGTWK00009469_z1611181808392235474182b_z1611151626282762828590b_z18031120572845935344906_3__segment2").send_keys("19443~Verizon Enterprise Center")
        driver.find_element_by_name("timeSheetForm").submit()
        driver.find_element_by_id("select_label_z1611111809130665190690fz1611111817013817038990f_VZGTWK00009469_z1611181808392235474182b_z1611151626282762828590b_z18031120572845935344906_3__segment3").click()
        driver.find_element_by_id("select_label_z1611111809130665190690fz1611111817013817038990f_VZGTWK00009469_z1611181808392235474182b_z1611151626282762828590b_z18031120572845935344906_3__segment3").send_keys(Keys.DOWN)
        driver.find_element_by_id("select_label_z1611111809130665190690fz1611111817013817038990f_VZGTWK00009469_z1611181808392235474182b_z1611151626282762828590b_z18031120572845935344906_3__segment3").clear()
        driver.find_element_by_id("select_label_z1611111809130665190690fz1611111817013817038990f_VZGTWK00009469_z1611181808392235474182b_z1611151626282762828590b_z18031120572845935344906_3__segment3").send_keys("FUNCTIONALITY TESTING & INSTALL - EXCLUDES UAT~06A~LABOR_EXPENSE~780900~")
        driver.find_element_by_name("timeSheetForm").submit()
        driver.find_element_by_xpath("(//a[contains(text(),'Update')])[3]").click()
        driver.find_element_by_id("t_z17102516194911574423935_b_2_r1").click()
        driver.find_element_by_id("t_z17102516194911574423935_b_2_r1").clear()
        driver.find_element_by_id("t_z17102516194911574423935_b_2_r1").send_keys("1.00")
        driver.find_element_by_id("t_z17102516194911574423935_b_3_r1").click()
        driver.find_element_by_id("t_z17102516194911574423935_b_3_r1").clear()
        driver.find_element_by_id("t_z17102516194911574423935_b_3_r1").send_keys("1.00")
        driver.find_element_by_id("t_z17102516194911574423935_b_4_r1").click()
        driver.find_element_by_id("t_z17102516194911574423935_b_4_r1").clear()
        driver.find_element_by_id("t_z17102516194911574423935_b_4_r1").send_keys("1.00")
        driver.find_element_by_id("t_z17102516194911574423935_b_5_r1").click()
        driver.find_element_by_id("t_z17102516194911574423935_b_5_r1").clear()
        driver.find_element_by_id("t_z17102516194911574423935_b_5_r1").send_keys("1.00")
        driver.find_element_by_id("t_z17102516194911574423935_b_6_r1").click()
        driver.find_element_by_id("t_z17102516194911574423935_b_6_r1").clear()
        driver.find_element_by_id("t_z17102516194911574423935_b_6_r1").send_keys("1.00")
        driver.find_element_by_id("t_z17102516194911574423935_b_2_r2").click()
        driver.find_element_by_id("t_z17102516194911574423935_b_2_r2").clear()
        driver.find_element_by_id("t_z17102516194911574423935_b_2_r2").send_keys("5.00")
        driver.find_element_by_id("t_z17102516194911574423935_b_3_r2").click()
        driver.find_element_by_id("t_z17102516194911574423935_b_3_r2").clear()
        driver.find_element_by_id("t_z17102516194911574423935_b_3_r2").send_keys("5.00")
        driver.find_element_by_id("t_z17102516194911574423935_b_4_r2").click()
        driver.find_element_by_id("t_z17102516194911574423935_b_4_r2").clear()
        driver.find_element_by_id("t_z17102516194911574423935_b_4_r2").send_keys("5.00")
        driver.find_element_by_id("t_z17102516194911574423935_b_5_r2").click()
        driver.find_element_by_id("t_z17102516194911574423935_b_5_r2").clear()
        driver.find_element_by_id("t_z17102516194911574423935_b_5_r2").send_keys("5.00")
        driver.find_element_by_id("t_z17102516194911574423935_b_6_r2").click()
        driver.find_element_by_id("t_z17102516194911574423935_b_6_r2").clear()
        driver.find_element_by_id("t_z17102516194911574423935_b_6_r2").send_keys("5.00")
        driver.find_element_by_id("t_z17102516194911574423935_b_2_r3").click()
        driver.find_element_by_id("t_z17102516194911574423935_b_2_r3").clear()
        driver.find_element_by_id("t_z17102516194911574423935_b_2_r3").send_keys("2.00")
        driver.find_element_by_id("t_z17102516194911574423935_b_3_r3").click()
        driver.find_element_by_id("t_z17102516194911574423935_b_3_r3").clear()
        driver.find_element_by_id("t_z17102516194911574423935_b_3_r3").send_keys("2.00")
        driver.find_element_by_id("t_z17102516194911574423935_b_4_r3").click()
        driver.find_element_by_id("t_z17102516194911574423935_b_4_r3").clear()
        driver.find_element_by_id("t_z17102516194911574423935_b_4_r3").send_keys("2.00")
        driver.find_element_by_id("t_z17102516194911574423935_b_5_r3").click()
        driver.find_element_by_id("t_z17102516194911574423935_b_5_r3").clear()
        driver.find_element_by_id("t_z17102516194911574423935_b_5_r3").send_keys("2.00")
        driver.find_element_by_id("t_z17102516194911574423935_b_6_r3").click()
        driver.find_element_by_id("t_z17102516194911574423935_b_6_r3").clear()
        driver.find_element_by_id("t_z17102516194911574423935_b_6_r3").send_keys("2.00")
        # driver.find_element_by_xpath("//table[@id='timeSheetMainTable']/tbody/tr[18]/th").click()
        # driver.find_element_by_id("fgTSSubmit").click()
        # driver.find_element_by_id("update").click()
    
    def is_element_present(self, how, what):
        try: self.driver.find_element(by=how, value=what)
        except NoSuchElementException as e: return False
        return True
    
    def is_alert_present(self):
        try: self.driver.switch_to_alert()
        except NoAlertPresentException as e: return False
        return True
    
    def close_alert_and_get_its_text(self):
        try:
            alert = self.driver.switch_to_alert()
            alert_text = alert.text
            if self.accept_next_alert:
                alert.accept()
            else:
                alert.dismiss()
            return alert_text
        finally: self.accept_next_alert = True
    
    def tearDown(self):
        self.driver.quit()
        self.assertEqual([], self.verificationErrors)

if __name__ == "__main__":
    unittest.main()
